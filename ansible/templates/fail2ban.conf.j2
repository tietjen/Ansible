# Fail2ban configuration for {{ inventory_hostname }}
# Generated by Ansible

[DEFAULT]
# Ban hosts for specified time
bantime = {{ security_config.fail2ban_config.bantime }}
# Check for repeated failures
findtime = {{ security_config.fail2ban_config.findtime }}
# Allow failures before banning
maxretry = {{ security_config.fail2ban_config.maxretry }}

# Ban action
banaction = ufw

# Log level
loglevel = INFO

# Log target
logtarget = /var/log/fail2ban.log

# Socket
socket = /var/run/fail2ban/fail2ban.sock

# PID file
pidfile = /var/run/fail2ban/fail2ban.pid

# Database
dbfile = /var/lib/fail2ban/fail2ban.sqlite3

# Jail configuration
[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 3600
findtime = 600

[sshd-ddos]
enabled = true
port = ssh
filter = sshd-ddos
logpath = /var/log/auth.log
maxretry = 2
bantime = 7200
findtime = 600 