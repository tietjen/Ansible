# Fail2ban configuration for {{ inventory_hostname }}
# Generated by Ansible

[DEFAULT]
# Ban hosts for 1 hour
bantime = {{ security_config.fail2ban_config.bantime }}
# Check for repeated failures for 10 minutes
findtime = {{ security_config.fail2ban_config.findtime }}
# Allow 3 failures before banning
maxretry = {{ security_config.fail2ban_config.maxretry }}

# Ban action
banaction = ufw

# Log level
loglevel = INFO

# Log target
logtarget = /var/log/fail2ban.log

# Socket
socket = /var/run/fail2ban/fail2ban.sock

# PID file
pidfile = /var/run/fail2ban/fail2ban.pid

# Database
dbfile = /var/lib/fail2ban/fail2ban.sqlite3

# Jail configuration
[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 3600
findtime = 600

[sshd-ddos]
enabled = true
port = ssh
filter = sshd-ddos
logpath = /var/log/auth.log
maxretry = 2
bantime = 7200
findtime = 600

[nginx-http-auth]
enabled = true
filter = nginx-http-auth
logpath = /var/log/nginx/error.log
maxretry = 3
bantime = 3600
findtime = 600

[apache-auth]
enabled = true
filter = apache-auth
logpath = /var/log/apache2/error.log
maxretry = 3
bantime = 3600
findtime = 600

[docker]
enabled = true
filter = docker
logpath = /var/log/docker.log
maxretry = 5
bantime = 1800
findtime = 600 